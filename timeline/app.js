var occs = [
  {
    entity: {
      id: 0,
      title: 'Mon Jun 08 2020',
      date: '2020-06-08T22:19:16.074Z',
    },
    document: {
      id: 23700962,
      title: 'cat cat',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 1,
      title: 'Tue Jun 09 2020',
      date: '2020-06-09T22:19:16.074Z',
    },
    document: {
      id: 23700962,
      title: 'dog potato',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 2,
      title: 'Thu Jun 11 2020',
      date: '2020-06-11T22:19:16.074Z',
    },
    document: {
      id: 23700962,
      title: 'potato report',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 3,
      title: 'Sun Jun 14 2020',
      date: '2020-06-14T22:19:16.074Z',
    },
    document: {
      id: 23700962,
      title: 'crime election',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 4,
      title: 'Thu Jun 18 2020',
      date: '2020-06-18T22:19:16.074Z',
    },
    document: {
      id: 23700960,
      title: 'report cat',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 5,
      title: 'Thu Jun 18 2020',
      date: '2020-06-18T22:19:16.074Z',
    },
    document: {
      id: 23700960,
      title: 'culture culture',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 6,
      title: 'Fri Jun 19 2020',
      date: '2020-06-19T22:19:16.074Z',
    },
    document: {
      id: 23700960,
      title: 'election robot',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 7,
      title: 'Sun Jun 21 2020',
      date: '2020-06-21T22:19:16.074Z',
    },
    document: {
      id: 23700960,
      title: 'robot dog',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 8,
      title: 'Wed Jun 24 2020',
      date: '2020-06-24T22:19:16.074Z',
    },
    document: {
      id: 23700960,
      title: 'cat crime',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 9,
      title: 'Sun Jun 28 2020',
      date: '2020-06-28T22:19:16.074Z',
    },
    document: {
      id: 23700960,
      title: 'dog culture',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 10,
      title: 'Sun Jun 28 2020',
      date: '2020-06-28T22:19:16.074Z',
    },
    document: {
      id: 23700960,
      title: 'potato potato',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 11,
      title: 'Mon Jun 29 2020',
      date: '2020-06-29T22:19:16.074Z',
    },
    document: {
      id: 23700960,
      title: 'crime report',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 12,
      title: 'Wed Jul 01 2020',
      date: '2020-07-01T22:19:16.074Z',
    },
    document: {
      id: 23700960,
      title: 'report election',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 13,
      title: 'Sat Jul 04 2020',
      date: '2020-07-04T22:19:16.074Z',
    },
    document: {
      id: 23700960,
      title: 'culture cat',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 14,
      title: 'Wed Jul 08 2020',
      date: '2020-07-08T22:19:16.074Z',
    },
    document: {
      id: 23700960,
      title: 'election potato',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 15,
      title: 'Wed Jul 08 2020',
      date: '2020-07-08T22:19:16.074Z',
    },
    document: {
      id: 23700960,
      title: 'robot robot',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 16,
      title: 'Thu Jul 09 2020',
      date: '2020-07-09T22:19:16.074Z',
    },
    document: {
      id: 23700960,
      title: 'cat dog',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 17,
      title: 'Sat Jul 11 2020',
      date: '2020-07-11T22:19:16.074Z',
    },
    document: {
      id: 23700960,
      title: 'dog crime',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 18,
      title: 'Tue Jul 14 2020',
      date: '2020-07-14T22:19:16.074Z',
    },
    document: {
      id: 23700960,
      title: 'potato culture',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 19,
      title: 'Sat Jul 18 2020',
      date: '2020-07-18T22:19:16.074Z',
    },
    document: {
      id: 23700960,
      title: 'crime robot',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 20,
      title: 'Sat Jul 18 2020',
      date: '2020-07-18T22:19:16.074Z',
    },
    document: {
      id: 23700960,
      title: 'report report',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 21,
      title: 'Sun Jul 19 2020',
      date: '2020-07-19T22:19:16.074Z',
    },
    document: {
      id: 23700960,
      title: 'culture election',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 22,
      title: 'Tue Jul 21 2020',
      date: '2020-07-21T22:19:16.074Z',
    },
    document: {
      id: 23700960,
      title: 'election cat',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 23,
      title: 'Fri Jul 24 2020',
      date: '2020-07-24T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'robot potato',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 24,
      title: 'Tue Jul 28 2020',
      date: '2020-07-28T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'cat report',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 25,
      title: 'Tue Jul 28 2020',
      date: '2020-07-28T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'dog dog',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 26,
      title: 'Wed Jul 29 2020',
      date: '2020-07-29T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'potato crime',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 27,
      title: 'Fri Jul 31 2020',
      date: '2020-07-31T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'crime culture',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 28,
      title: 'Mon Aug 03 2020',
      date: '2020-08-03T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'report robot',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 29,
      title: 'Fri Aug 07 2020',
      date: '2020-08-07T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'culture dog',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 30,
      title: 'Fri Aug 07 2020',
      date: '2020-08-07T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'election election',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 31,
      title: 'Sat Aug 08 2020',
      date: '2020-08-08T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'robot cat',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 32,
      title: 'Mon Aug 10 2020',
      date: '2020-08-10T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'cat potato',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 33,
      title: 'Thu Aug 13 2020',
      date: '2020-08-13T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'dog report',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 34,
      title: 'Mon Aug 17 2020',
      date: '2020-08-17T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'potato election',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 35,
      title: 'Mon Aug 17 2020',
      date: '2020-08-17T22:19:16.074Z',
    },
    document: {
      id: 1000035,
      title: 'crime crime',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 36,
      title: 'Tue Aug 18 2020',
      date: '2020-08-18T22:19:16.074Z',
    },
    document: {
      id: 1000036,
      title: 'report culture',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 37,
      title: 'Thu Aug 20 2020',
      date: '2020-08-20T22:19:16.074Z',
    },
    document: {
      id: 1000037,
      title: 'culture robot',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 38,
      title: 'Sun Aug 23 2020',
      date: '2020-08-23T22:19:16.074Z',
    },
    document: {
      id: 1000038,
      title: 'election dog',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 39,
      title: 'Thu Aug 27 2020',
      date: '2020-08-27T22:19:16.074Z',
    },
    document: {
      id: 1000039,
      title: 'robot crime',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 40,
      title: 'Thu Aug 27 2020',
      date: '2020-08-27T22:19:16.074Z',
    },
    document: {
      id: 1000040,
      title: 'cat cat',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 41,
      title: 'Fri Aug 28 2020',
      date: '2020-08-28T22:19:16.074Z',
    },
    document: {
      id: 1000041,
      title: 'dog potato',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 42,
      title: 'Sun Aug 30 2020',
      date: '2020-08-30T22:19:16.074Z',
    },
    document: {
      id: 1000042,
      title: 'potato report',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 43,
      title: 'Wed Sep 02 2020',
      date: '2020-09-02T22:19:16.074Z',
    },
    document: {
      id: 1000043,
      title: 'crime election',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 44,
      title: 'Sun Sep 06 2020',
      date: '2020-09-06T22:19:16.074Z',
    },
    document: {
      id: 1000044,
      title: 'report cat',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 45,
      title: 'Sun Sep 06 2020',
      date: '2020-09-06T22:19:16.074Z',
    },
    document: {
      id: 1000045,
      title: 'culture culture',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 46,
      title: 'Mon Sep 07 2020',
      date: '2020-09-07T22:19:16.074Z',
    },
    document: {
      id: 1000046,
      title: 'election robot',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 47,
      title: 'Wed Sep 09 2020',
      date: '2020-09-09T22:19:16.074Z',
    },
    document: {
      id: 1000047,
      title: 'robot dog',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 48,
      title: 'Sat Sep 12 2020',
      date: '2020-09-12T22:19:16.074Z',
    },
    document: {
      id: 1000048,
      title: 'cat crime',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 49,
      title: 'Wed Sep 16 2020',
      date: '2020-09-16T22:19:16.074Z',
    },
    document: {
      id: 1000049,
      title: 'dog culture',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 50,
      title: 'Wed Sep 16 2020',
      date: '2020-09-16T22:19:16.074Z',
    },
    document: {
      id: 1000050,
      title: 'potato potato',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 51,
      title: 'Thu Sep 17 2020',
      date: '2020-09-17T22:19:16.074Z',
    },
    document: {
      id: 1000051,
      title: 'crime report',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 52,
      title: 'Sat Sep 19 2020',
      date: '2020-09-19T22:19:16.074Z',
    },
    document: {
      id: 1000052,
      title: 'report election',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 53,
      title: 'Tue Sep 22 2020',
      date: '2020-09-22T22:19:16.074Z',
    },
    document: {
      id: 1000053,
      title: 'culture cat',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 54,
      title: 'Sat Sep 26 2020',
      date: '2020-09-26T22:19:16.074Z',
    },
    document: {
      id: 1000054,
      title: 'election potato',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 55,
      title: 'Sat Sep 26 2020',
      date: '2020-09-26T22:19:16.074Z',
    },
    document: {
      id: 1000055,
      title: 'robot robot',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 56,
      title: 'Sun Sep 27 2020',
      date: '2020-09-27T22:19:16.074Z',
    },
    document: {
      id: 1000056,
      title: 'cat dog',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 57,
      title: 'Tue Sep 29 2020',
      date: '2020-09-29T22:19:16.074Z',
    },
    document: {
      id: 1000057,
      title: 'dog crime',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 58,
      title: 'Fri Oct 02 2020',
      date: '2020-10-02T22:19:16.074Z',
    },
    document: {
      id: 1000058,
      title: 'potato culture',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 59,
      title: 'Tue Oct 06 2020',
      date: '2020-10-06T22:19:16.074Z',
    },
    document: {
      id: 1000059,
      title: 'crime robot',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 60,
      title: 'Tue Oct 06 2020',
      date: '2020-10-06T22:19:16.074Z',
    },
    document: {
      id: 1000060,
      title: 'report report',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 61,
      title: 'Wed Oct 07 2020',
      date: '2020-10-07T22:19:16.074Z',
    },
    document: {
      id: 1000061,
      title: 'culture election',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 62,
      title: 'Fri Oct 09 2020',
      date: '2020-10-09T22:19:16.074Z',
    },
    document: {
      id: 1000062,
      title: 'election cat',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 63,
      title: 'Mon Oct 12 2020',
      date: '2020-10-12T22:19:16.074Z',
    },
    document: {
      id: 1000063,
      title: 'robot potato',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 64,
      title: 'Fri Oct 16 2020',
      date: '2020-10-16T22:19:16.074Z',
    },
    document: {
      id: 1000064,
      title: 'cat report',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 65,
      title: 'Fri Oct 16 2020',
      date: '2020-10-16T22:19:16.074Z',
    },
    document: {
      id: 1000065,
      title: 'dog dog',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 66,
      title: 'Sat Oct 17 2020',
      date: '2020-10-17T22:19:16.074Z',
    },
    document: {
      id: 1000066,
      title: 'potato crime',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 67,
      title: 'Mon Oct 19 2020',
      date: '2020-10-19T22:19:16.074Z',
    },
    document: {
      id: 1000067,
      title: 'crime culture',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 68,
      title: 'Thu Oct 22 2020',
      date: '2020-10-22T22:19:16.074Z',
    },
    document: {
      id: 1000068,
      title: 'report robot',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 69,
      title: 'Mon Oct 26 2020',
      date: '2020-10-26T22:19:16.074Z',
    },
    document: {
      id: 1000069,
      title: 'culture dog',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 70,
      title: 'Mon Oct 26 2020',
      date: '2020-10-26T22:19:16.074Z',
    },
    document: {
      id: 1000070,
      title: 'election election',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 71,
      title: 'Tue Oct 27 2020',
      date: '2020-10-27T22:19:16.074Z',
    },
    document: {
      id: 1000071,
      title: 'robot cat',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 72,
      title: 'Thu Oct 29 2020',
      date: '2020-10-29T22:19:16.074Z',
    },
    document: {
      id: 1000072,
      title: 'cat potato',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 73,
      title: 'Sun Nov 01 2020',
      date: '2020-11-01T22:19:16.074Z',
    },
    document: {
      id: 1000073,
      title: 'dog report',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 74,
      title: 'Thu Nov 05 2020',
      date: '2020-11-05T22:19:16.074Z',
    },
    document: {
      id: 1000074,
      title: 'potato election',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 75,
      title: 'Thu Nov 05 2020',
      date: '2020-11-05T22:19:16.074Z',
    },
    document: {
      id: 1000075,
      title: 'crime crime',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 76,
      title: 'Fri Nov 06 2020',
      date: '2020-11-06T22:19:16.074Z',
    },
    document: {
      id: 1000076,
      title: 'report culture',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 77,
      title: 'Sun Nov 08 2020',
      date: '2020-11-08T22:19:16.074Z',
    },
    document: {
      id: 1000077,
      title: 'culture robot',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 78,
      title: 'Wed Nov 11 2020',
      date: '2020-11-11T22:19:16.074Z',
    },
    document: {
      id: 1000078,
      title: 'election dog',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 79,
      title: 'Sun Nov 15 2020',
      date: '2020-11-15T22:19:16.074Z',
    },
    document: {
      id: 1000079,
      title: 'robot crime',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 80,
      title: 'Sun Nov 15 2020',
      date: '2020-11-15T22:19:16.074Z',
    },
    document: {
      id: 1000080,
      title: 'cat cat',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 81,
      title: 'Mon Nov 16 2020',
      date: '2020-11-16T22:19:16.074Z',
    },
    document: {
      id: 1000081,
      title: 'dog potato',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 82,
      title: 'Wed Nov 18 2020',
      date: '2020-11-18T22:19:16.074Z',
    },
    document: {
      id: 1000082,
      title: 'potato report',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 83,
      title: 'Sat Nov 21 2020',
      date: '2020-11-21T22:19:16.074Z',
    },
    document: {
      id: 1000083,
      title: 'crime election',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 84,
      title: 'Wed Nov 25 2020',
      date: '2020-11-25T22:19:16.074Z',
    },
    document: {
      id: 1000084,
      title: 'report cat',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 85,
      title: 'Wed Nov 25 2020',
      date: '2020-11-25T22:19:16.074Z',
    },
    document: {
      id: 1000085,
      title: 'culture culture',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 86,
      title: 'Thu Nov 26 2020',
      date: '2020-11-26T22:19:16.074Z',
    },
    document: {
      id: 1000086,
      title: 'election robot',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 87,
      title: 'Sat Nov 28 2020',
      date: '2020-11-28T22:19:16.074Z',
    },
    document: {
      id: 1000087,
      title: 'robot dog',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 88,
      title: 'Tue Dec 01 2020',
      date: '2020-12-01T22:19:16.074Z',
    },
    document: {
      id: 1000088,
      title: 'cat crime',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 89,
      title: 'Sat Dec 05 2020',
      date: '2020-12-05T22:19:16.074Z',
    },
    document: {
      id: 1000089,
      title: 'dog culture',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 90,
      title: 'Sat Dec 05 2020',
      date: '2020-12-05T22:19:16.074Z',
    },
    document: {
      id: 1000090,
      title: 'potato potato',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 91,
      title: 'Sun Dec 06 2020',
      date: '2020-12-06T22:19:16.074Z',
    },
    document: {
      id: 1000091,
      title: 'crime report',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 92,
      title: 'Tue Dec 08 2020',
      date: '2020-12-08T22:19:16.074Z',
    },
    document: {
      id: 1000092,
      title: 'report election',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 93,
      title: 'Fri Dec 11 2020',
      date: '2020-12-11T22:19:16.074Z',
    },
    document: {
      id: 1000093,
      title: 'culture cat',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 94,
      title: 'Tue Dec 15 2020',
      date: '2020-12-15T22:19:16.074Z',
    },
    document: {
      id: 1000094,
      title: 'election potato',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 95,
      title: 'Tue Dec 15 2020',
      date: '2020-12-15T22:19:16.074Z',
    },
    document: {
      id: 1000095,
      title: 'robot robot',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 96,
      title: 'Wed Dec 16 2020',
      date: '2020-12-16T22:19:16.074Z',
    },
    document: {
      id: 1000096,
      title: 'cat dog',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 97,
      title: 'Fri Dec 18 2020',
      date: '2020-12-18T22:19:16.074Z',
    },
    document: {
      id: 1000097,
      title: 'dog crime',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 98,
      title: 'Mon Dec 21 2020',
      date: '2020-12-21T22:19:16.074Z',
    },
    document: {
      id: 1000098,
      title: 'potato culture',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 99,
      title: 'Fri Dec 25 2020',
      date: '2020-12-25T22:19:16.074Z',
    },
    document: {
      id: 1000099,
      title: 'crime robot',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 100,
      title: 'Fri Dec 25 2020',
      date: '2020-12-25T22:19:16.074Z',
    },
    document: {
      id: 1000100,
      title: 'report report',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 101,
      title: 'Sat Dec 26 2020',
      date: '2020-12-26T22:19:16.074Z',
    },
    document: {
      id: 1000101,
      title: 'culture election',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 102,
      title: 'Mon Dec 28 2020',
      date: '2020-12-28T22:19:16.074Z',
    },
    document: {
      id: 1000102,
      title: 'election cat',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 103,
      title: 'Thu Dec 31 2020',
      date: '2020-12-31T22:19:16.074Z',
    },
    document: {
      id: 1000103,
      title: 'robot potato',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 104,
      title: 'Mon Jan 04 2021',
      date: '2021-01-04T22:19:16.074Z',
    },
    document: {
      id: 1000104,
      title: 'cat report',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 105,
      title: 'Mon Jan 04 2021',
      date: '2021-01-04T22:19:16.074Z',
    },
    document: {
      id: 1000105,
      title: 'dog dog',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 106,
      title: 'Tue Jan 05 2021',
      date: '2021-01-05T22:19:16.074Z',
    },
    document: {
      id: 1000106,
      title: 'potato crime',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 107,
      title: 'Thu Jan 07 2021',
      date: '2021-01-07T22:19:16.074Z',
    },
    document: {
      id: 1000107,
      title: 'crime culture',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 108,
      title: 'Sun Jan 10 2021',
      date: '2021-01-10T22:19:16.074Z',
    },
    document: {
      id: 1000108,
      title: 'report robot',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 109,
      title: 'Thu Jan 14 2021',
      date: '2021-01-14T22:19:16.074Z',
    },
    document: {
      id: 1000109,
      title: 'culture dog',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 110,
      title: 'Thu Jan 14 2021',
      date: '2021-01-14T22:19:16.074Z',
    },
    document: {
      id: 1000110,
      title: 'election election',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 111,
      title: 'Fri Jan 15 2021',
      date: '2021-01-15T22:19:16.074Z',
    },
    document: {
      id: 1000111,
      title: 'robot cat',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 112,
      title: 'Sun Jan 17 2021',
      date: '2021-01-17T22:19:16.074Z',
    },
    document: {
      id: 1000112,
      title: 'cat potato',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 113,
      title: 'Wed Jan 20 2021',
      date: '2021-01-20T22:19:16.074Z',
    },
    document: {
      id: 1000113,
      title: 'dog report',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 114,
      title: 'Sun Jan 24 2021',
      date: '2021-01-24T22:19:16.074Z',
    },
    document: {
      id: 1000114,
      title: 'potato election',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 115,
      title: 'Sun Jan 24 2021',
      date: '2021-01-24T22:19:16.074Z',
    },
    document: {
      id: 1000115,
      title: 'crime crime',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 116,
      title: 'Mon Jan 25 2021',
      date: '2021-01-25T22:19:16.074Z',
    },
    document: {
      id: 1000116,
      title: 'report culture',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 117,
      title: 'Wed Jan 27 2021',
      date: '2021-01-27T22:19:16.074Z',
    },
    document: {
      id: 1000117,
      title: 'culture robot',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 118,
      title: 'Sat Jan 30 2021',
      date: '2021-01-30T22:19:16.074Z',
    },
    document: {
      id: 1000118,
      title: 'election dog',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 119,
      title: 'Wed Feb 03 2021',
      date: '2021-02-03T22:19:16.074Z',
    },
    document: {
      id: 1000119,
      title: 'robot crime',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 120,
      title: 'Wed Feb 03 2021',
      date: '2021-02-03T22:19:16.074Z',
    },
    document: {
      id: 1000120,
      title: 'cat cat',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 121,
      title: 'Thu Feb 04 2021',
      date: '2021-02-04T22:19:16.074Z',
    },
    document: {
      id: 1000121,
      title: 'dog potato',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 122,
      title: 'Sat Feb 06 2021',
      date: '2021-02-06T22:19:16.074Z',
    },
    document: {
      id: 1000122,
      title: 'potato report',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 123,
      title: 'Tue Feb 09 2021',
      date: '2021-02-09T22:19:16.074Z',
    },
    document: {
      id: 1000123,
      title: 'crime election',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 124,
      title: 'Sat Feb 13 2021',
      date: '2021-02-13T22:19:16.074Z',
    },
    document: {
      id: 1000124,
      title: 'report cat',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 125,
      title: 'Sat Feb 13 2021',
      date: '2021-02-13T22:19:16.074Z',
    },
    document: {
      id: 1000125,
      title: 'culture culture',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 126,
      title: 'Sun Feb 14 2021',
      date: '2021-02-14T22:19:16.074Z',
    },
    document: {
      id: 1000126,
      title: 'election robot',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 127,
      title: 'Tue Feb 16 2021',
      date: '2021-02-16T22:19:16.074Z',
    },
    document: {
      id: 1000127,
      title: 'robot dog',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 128,
      title: 'Fri Feb 19 2021',
      date: '2021-02-19T22:19:16.074Z',
    },
    document: {
      id: 1000128,
      title: 'cat crime',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 129,
      title: 'Tue Feb 23 2021',
      date: '2021-02-23T22:19:16.074Z',
    },
    document: {
      id: 1000129,
      title: 'dog culture',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 130,
      title: 'Tue Feb 23 2021',
      date: '2021-02-23T22:19:16.074Z',
    },
    document: {
      id: 1000130,
      title: 'potato potato',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 131,
      title: 'Wed Feb 24 2021',
      date: '2021-02-24T22:19:16.074Z',
    },
    document: {
      id: 1000131,
      title: 'crime report',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 132,
      title: 'Fri Feb 26 2021',
      date: '2021-02-26T22:19:16.074Z',
    },
    document: {
      id: 1000132,
      title: 'report election',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 133,
      title: 'Mon Mar 01 2021',
      date: '2021-03-01T22:19:16.074Z',
    },
    document: {
      id: 1000133,
      title: 'culture cat',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 134,
      title: 'Fri Mar 05 2021',
      date: '2021-03-05T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'election potato',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 135,
      title: 'Fri Mar 05 2021',
      date: '2021-03-05T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'robot robot',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 136,
      title: 'Sat Mar 06 2021',
      date: '2021-03-06T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'cat dog',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 137,
      title: 'Mon Mar 08 2021',
      date: '2021-03-08T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'dog crime',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 138,
      title: 'Thu Mar 11 2021',
      date: '2021-03-11T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'potato culture',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 139,
      title: 'Mon Mar 15 2021',
      date: '2021-03-15T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'crime robot',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 140,
      title: 'Mon Mar 15 2021',
      date: '2021-03-15T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'report report',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 141,
      title: 'Tue Mar 16 2021',
      date: '2021-03-16T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'culture election',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 142,
      title: 'Thu Mar 18 2021',
      date: '2021-03-18T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'election cat',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 143,
      title: 'Sun Mar 21 2021',
      date: '2021-03-21T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'robot potato',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 144,
      title: 'Thu Mar 25 2021',
      date: '2021-03-25T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'cat report',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 145,
      title: 'Thu Mar 25 2021',
      date: '2021-03-25T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'dog dog',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 146,
      title: 'Fri Mar 26 2021',
      date: '2021-03-26T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'potato crime',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 147,
      title: 'Sun Mar 28 2021',
      date: '2021-03-28T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'crime culture',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 148,
      title: 'Wed Mar 31 2021',
      date: '2021-03-31T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'report robot',
      url: '23700960',
    },
  },
  {
    entity: {
      id: 149,
      title: 'Sun Apr 04 2021',
      date: '2021-04-04T22:19:16.074Z',
    },
    document: {
      id: 23700953,
      title: 'culture dog',
      url: '23700960',
    },
  },
];

/* global d3 */

// Constants
const yearHeight = 64;
const monthHeight = 64;
const dayHeight = 64;
const timelineLength = (occs.length + 1) * dayHeight;
const maxBarLength = 200;
const startTime = getDateTimeFromTitle(occs[0].entity.title);
const endTime = getDateTimeFromTitle(occs[occs.length - 1].entity.title);
var englishMonthNames = [
  'January',
  'February',
  'March',
  'April',
  'May',
  'June',
  'July',
  'August',
  'September',
  'October',
  'November',
  'December',
];
// State
var occsByYear = {};
var mostOccsInAYear = 0;
var sortedOccs = populateOccsDict();
const lastYear = sortedOccs[sortedOccs.length - 1];
const firstYear = sortedOccs[0];

function populateOccsDict() {
  occs.forEach(putInYearDict);
  var sortedOccs = Object.keys(occsByYear).sort();
  if (sortedOccs.length < 1) {
    throw new Error('No years found in data.');
  }
  return sortedOccs;

  // Side effect: Updates mostOccsInAYear.
  function putInYearDict(occ) {
    const year = new Date(occ.entity.date).getFullYear();
    var occsForYear = occsByYear[year];
    if (!occsForYear) {
      occsForYear = [];
      occsByYear[year] = occsForYear;
    }
    occsForYear.push(occ);
    occsForYear.sort((a, b) => (a.entity.date < b.entity.date ? -1 : 1));

    if (occsForYear.length > mostOccsInAYear) {
      mostOccsInAYear = occsForYear.length;
    }
  }
}

// Scales
var timeScale = d3
  .scaleLinear()
  .domain([startTime, endTime])
  .range([dayHeight / 2, timelineLength]);

var yearWidthScale = d3
  .scaleLinear()
  .domain([0, mostOccsInAYear])
  .range([0, maxBarLength]);

var yearYScale = d3
  .scaleLinear()
  .domain([firstYear, lastYear])
  .range([0, yearHeight * (lastYear - firstYear)]);

// Selections
var docContainerSel = d3.select('.doc-container');
var docFrameSel = d3.select('#doc-frame');
var yearMapContainerSel = d3.select('.year-map-container');
var monthMapContainerSel = d3.select('.month-map-container');
var yearMapToggleSel = d3.select('#year-map-toggle-button');
var monthMapToggleSel = d3.select('#month-map-toggle-button');
var docCloseSel = d3.select('#doc-close-button');
var monthContainer = d3.select('.month-map');

// Handlers
yearMapToggleSel.on('click', onYearMapToggleClick);
monthMapToggleSel.on('click', onMonthMapToggleClick);
docCloseSel.on('click', onDocCloseClick);

// Init
renderMainTimeline();
renderMonthMap(firstYear);
renderYearMap();

function renderMainTimeline() {
  var dayContainer = d3.select('.day-map');
  dayContainer.attr('height', timelineLength);

  var newTicks = dayContainer
    .select('.timeline-layer')
    .selectAll('.tick')
    .data(occs, makeOccId)
    .enter()
    .append('g')
    .classed('tick', true)
    .attr('id', makeOccId);

  newTicks
    .append('line')
    .classed('tick', true)
    .attr('x1', 0)
    .attr('x2', 50)
    .attr('y1', 0)
    .attr('y2', 0);
  newTicks
    .append('text')
    .text((occ) => occ.entity.title)
    .attr('x', 54)
    .attr('y', '0.3em');
  newTicks
    .append('use')
    .attr('href', '#doc-icon-def')
    .attr('x', 320 - 24 - 10)
    .attr('y', -32 / 2);
  newTicks.attr('transform', getTransformForTick);
  newTicks.on('click', onTickClick);
}

function renderYearMap() {
  var yearContainer = d3.select('.year-map');

  yearContainer
    .attr('height', yearYScale(sortedOccs[sortedOccs.length - 1]) + yearHeight)
    .attr('width', maxBarLength);

  var newBars = yearContainer
    .select('.timeline-layer')
    .selectAll('.year')
    .data(Object.keys(occsByYear), (x) => x)
    .enter()
    .append('g')
    .classed('year', true);

  newBars
    .append('rect')
    .classed('bar', true)
    .attr('height', yearHeight)
    .attr('width', (year) => yearWidthScale(occsByYear[year].length));
  newBars
    .append('text')
    .text((year) => year)
    .attr('x', 5)
    .attr('y', '1em');
  newBars
    .append('text')
    .text((year) => `${occsByYear[year].length} documents`)
    .attr('x', 5)
    .attr('y', '2em');
  newBars.attr('transform', getTransformForYear);
  newBars.on('click', onYearClick);
}

function renderMonthMap(year) {
  var occsByMonth = groupOccsByMonth(occsByYear[year]);
  var monthWidthScale = d3
    .scaleLinear()
    .domain([
      0,
      Object.values(occsByMonth).reduce(
        (maxOccs, occs) => (occs.length > maxOccs ? occs.length : maxOccs),
        0
      ),
    ])
    .range([0, maxBarLength]);

  monthContainer.attr('height', 12 * monthHeight).attr('width', maxBarLength);

  var months = monthContainer
    .select('.timeline-layer')
    .selectAll('.month')
    .data(Object.keys(occsByMonth), (x) => x);

  months.exit().remove();

  var newMonths = months.enter().append('g').classed('month', true);

  newMonths.append('rect').classed('bar', true).attr('height', monthHeight);
  newMonths
    .append('text')
    .text((month) => englishMonthNames[month])
    .attr('x', 5)
    .attr('y', '1em');
  newMonths
    .append('text')
    .attr('x', 5)
    .attr('y', '2em')
    .classed('doc-count', true);
  newMonths.attr(
    'transform',
    (month) => `translate(0, ${monthHeight * month})`
  );
  newMonths.on('click', onMonthClick);

  var currentMonths = months.merge(newMonths);
  currentMonths
    .select('.bar')
    .attr('width', (month) => monthWidthScale(occsByMonth[month].length));
  currentMonths
    .select('.doc-count')
    .text((month) => `${occsByMonth[month].length} documents`);

  function onMonthClick(e, month) {
    var sortedOccs = occsByMonth[month];
    if (!sortedOccs || sortedOccs.length < 1) {
      return;
    }

    scrollOccurrenceIntoView(sortedOccs[0]);
  }
}

function getTransformForTick(occ) {
  const y = timeScale(getDateTimeFromTitle(occ.entity.title));
  return `translate(0, ${y})`;
}

function getTransformForYear(year) {
  const y = yearYScale(year);
  return `translate(0, ${y})`;
}

function getDateTimeFromTitle(title) {
  var date = new Date(title);
  return date.getTime();
}

function makeOccId(occ) {
  return occ.document.id + '-' + occ.entity.id;
}

function onTickClick(e, occ) {
  docFrameSel.attr(
    'src',
    `https://embed.documentcloud.org/documents/${occ.document.id}/?embed=1&amp;responsive=1&amp;title=1`
  );
  docContainerSel.attr('title', occ.document.title);
  docContainerSel.classed('hidden', false);
}

function onYearClick(e, year) {
  var sortedOccs = occsByYear[year];
  if (!sortedOccs || sortedOccs.length < 1) {
    return;
  }

  scrollOccurrenceIntoView(sortedOccs[0]);
  renderMonthMap(year);
}

function onYearMapToggleClick() {
  yearMapContainerSel.classed('hidden', !yearMapContainerSel.classed('hidden'));
  yearMapToggleSel.text(
    yearMapContainerSel.classed('hidden') ? 'Show year map' : 'Hide year map'
  );
}

function onMonthMapToggleClick() {
  monthMapContainerSel.classed(
    'hidden',
    !monthMapContainerSel.classed('hidden')
  );
  monthMapToggleSel.text(
    monthMapContainerSel.classed('hidden') ? 'Show month map' : 'Hide month map'
  );
}

function onDocCloseClick() {
  docContainerSel.classed('hidden', true);
}

function scrollOccurrenceIntoView(occ) {
  document.getElementById(makeOccId(occ)).scrollIntoView();
}

function groupOccsByMonth(occs) {
  var occsByMonth = {};
  occs.forEach(putInMonthDict);
  return occsByMonth;

  function putInMonthDict(occ) {
    const month = new Date(occ.entity.date).getMonth();
    var occsForMonth = occsByMonth[month];
    if (!occsForMonth) {
      occsForMonth = [];
      occsByMonth[month] = occsForMonth;
    }
    occsForMonth.push(occ);
    occsForMonth.sort((a, b) => (a.entity.date < b.entity.date ? -1 : 1));
  }
}
